- hosts: all
  remote_user: root
  become: yes
  tasks:
    - name: Create admins group
      group: name=admins state=present
    - name: Create developers group
      group: name=developers state=present

    - name: create alfred user
      user: name=alfred
        createhome=yes 
        groups=admins,developers
        state=present
        update_password=on_create
      register: alfred
   
    - name: Prompt alfred reset password
      shell: chage -d 0 alfred
      when: alfred.changed
    - name: create chris user
      user: name=chris
        createhome=yes 
        groups=developers
        state=present
        update_password=on_create
      register: chris
   
    - name: Prompt chris reset password
      shell: chage -d 0 chris
      when: chris.changed
